## Запуск проекта
 1. Заполнить .env 
 2. Выполнить миграции
 3. Создать суперпользователя:
 ```
 python3 manage.py csu
 ```
 4. Заполнить базу данных (фикстуры лежат в папке **data/**):
 ```
 python3 manage.py loaddata 'data/<filename>'
 ```
 5. Запустить сервер, зарегистрироваться
 
 *Чтобы увидеть на странице загруженные в базу данные, необходимо зайти в админку под суперпользователем и привязать их ко вновь созданному аккаунту (все: сообщения, клиенты, рассылки).
 Рассылки, загруженные в базу из фикстур, работать не будут - они созданы для примера (более того, НИ ОДНА рассылка, созданная через админку, работать не будет!)*
 
 Для получения рабочей рассылки необходимо создать ее через интерфейс сайта.
 Что будет работать через админку, описано ниже.
 	
 ## Концепция
 
 Отправка писем осуществляется через standalone скрипты python, исполняемые crontab'ом в заданное время с заданной периодчиностью. Принцип следующий:<br><br> 
 **Одна рассылка - один скрипт!**<br><br>
 Такой способ не будет грузить БД систематическими запросами, а выполнять только поставленные задачи.
 При этом выполнение скрипта отвязано от приложения, то есть оно не зависит от того, запущен ли сервер - зависит только от статуса сервера БД. (Плюс это или минус, зависит от ситуации). 
 На данном этапе разработки автоматическая очистка crontab от неактуальных (завершенных) задач не реализована (письма, разумеется, рассылаться не будут). 
 
 Пример скрипта можно посмотреть в папке **scripts/**.
 
 ## Логика работы
 
 Итак, пользователь создает сообщение, клиентов для рассылки.
 После этого он может создать рассылку.<br>
 Дата и время начала означают следующее:<br>
 &ensp; Время рассылки будет всегда одним и тем же, указанным в поле времени, за исключением случаев, когда дата и время раньше текущего момента - в таком случае первая рассылка улетит мгновенно, а следующие уже по расписанию<br>
 &ensp; Дата окончания означает последний день, когда рассылку можно осуществить.
 
 После нажатия кнопки **Сохранить** новой рассылке присваивается статус **создана**, и ее первичный ключ отправляется в класс **TaskManager** модуля **utils.task_manager**.
 У класса есть 2 публичных метода:
 1. **create_task(pk, start, freq)** - создает скрипт рассылки с названием **<id рассылки>_script.py**).
 2. **force_exec(pk)** - исполняет скрипт принудительно, вне очереди. Этот метод можно также запустить из консоли:
 ```
 python3 manage.py force_mail <id рассылки>
 ```
Важно учитывать, что как и плановые рассылки, принудительные исполняются при соблюдении тех же условий по времени и статусу.<br>
Решение так сделать принято из соображений простоты, и при необходимости ситуация исправляется без особых трудностей.
 
 В конце работы создается лог об успешности / неуспешности отправки, который можно будет посмотреть в соответствующем разделе.
 
 ### Типы пользователей
 
 1. Суперпользователь - очевидно обладает неограниченными правами в админке и правами обычного пользователя на сайте.
 2. Обычный пользователь - имеет интерфейс для управлениями своими рассылками. Может переключать статус рассылки между **приостановлена** и **запущена**.
 3. Менеджер - имеет интерфейс для деактивации пользователей и перевода рассылок в статус **остановлена** (пользователь не сможет самостоятельно исправить то, что прекратил менеджер). Работает только через интерфейс сайта, не должен иметь статус персонала.
 4. Контент-менеджер - занимается статьями в блоге; работает ТОЛЬКО через админку, поэтому должен иметь статус персонала.
 
 ### Кэширование
 
 Кэшируются на сайте только 2 вещи:
 	- страницы статей в блоге, так как мало вероятно, что они когда-либо будут меняться
 	- выборка 3 случайных статей на главную страницу.
 	
 Саму главную страницу кэшировать нельзя, так как после успешного входа пользователь не увидит свою панель навигации.
 
 ### Явные недоработки

 1. Timezone настроен на работу только в Москве. В других часовых поясах поведет себя непредсказуемо.
 2. Кнопка **Назад** не всегда отправляет действительно назад, а иногда совсем не туда, куда нужно. Требует доработок.
 3. Crontab нужно чистить через текстовый редактор вручную.
 4. Проект написан в Линуксе испытан на двух дистрах: Manjaro и Ubuntu. Но запуск в других ОС без допиливаний - под вопросом.   
